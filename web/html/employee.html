<!DOCTYPE html>
<html>
<head>
    <title> Forms </title>
</head>

<body>
    <script type = "text/javascript"> 

    function addItem() {
      var http = new XMLHttpRequest();
      var url = '/newItem';
      var item =document.getElementById("item")
      var inputItem = encodeURIComponent(item.value)
      var price =document.getElementById("price")
      var inputPrice = encodeURIComponent(price.value)
      var params = "item="+inputItem+"&"+"price="+inputPrice;
      http.open('POST', url, true);
      http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
    
      console.log()
      http.send(params);
      http.onreadystatechange = function() {
          if(http.readyState == 4 && http.status == 200) {
            alert("post success\n");
          }
          if(http.readyState == 4 && http.status == 500) {
            alert("unacceptable item/price\n");
          }
        }
    }
    function deleteItem() {
      var http = new XMLHttpRequest();
      var url = '/deleteItem';
      var item =document.getElementById("item")
      var inputItem = encodeURIComponent(item.value)
      var params = "item="+inputItem;
      http.open('DELETE', url, true);
      http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
    
      console.log()
      http.send(params);
      http.onreadystatechange = function() {
          if(http.readyState == 4 && http.status == 200) {
            alert("delete success\n");
          }
        }
    }

    function viewMenu(){
        var http = new XMLHttpRequest();
        http.onreadystatechange = function () {
          if(this.readyState == 4 && this.status == 200) {
            data = JSON.parse(this.responseText);
            
            var table = "<table menu='3' id='menu-table' >"
            table += "<tr> <td> " + "Item" + "</td> <td> " + "Price" +"</td><td></tr>";
            for(x in data) {
              table += "<tr> <td> " + data[x].Item + "</td> <td>" + data[x].Price + "</td> </tr>";
            }
            table += "</table>"
            document.getElementById("MENU").innerHTML = table;
          }
        }
        http.open('GET',"/getMenu",true)
        http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        http.send();
    }
    function viewOrder(){
        var http = new XMLHttpRequest();
        http.onreadystatechange = function () {
          if(this.readyState == 4 && this.status == 200) {
            data = JSON.parse(this.responseText);
            
            var table = "<table order='3' id='order-table' >"
            table += "<tr> <td> " + "Item" + "</td> <td> " + "Price" +"</td><td>"+"time" +"</td><td>"
            +"status" +"</td></tr>";
            for(x in data) {
              table += "<tr> <td> " + data[x].Item + "</td> <td>" + data[x].Price 
                + "</td> <td>" + data[x].OrderTime+ "</td> <td>" + data[x].OrderStatus  + "</td></tr>";
            }
            table += "</table>"
            document.getElementById("Order").innerHTML = table;
          }
        }
        http.open('GET',"/getOrders",true)
        http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        http.send();
    }
    

    function clearMenu(){
      var http = new XMLHttpRequest();
        http.onreadystatechange = function () {
          if(this.readyState == 4 && this.status == 200) {
          alert("menu now is clear!\n");
          }
        }
        http.open('GET',"/clearMenu",true)
        http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        http.send();
    }
  
    </script>

<label for="Item">Item:</label><br>
<input type="text" id="item" name="item"><br><br>
<label for="Price">Price:</label><br>
<input type="text" id="price" name="price"><br><br>
<button onclick="addItem()" > Add Item </button> 
<button onclick="deleteItem()" > Delete Item </button><br><br>
<button onclick="viewMenu()" > View Menu </button>
<button onclick="viewOrder()" > View Order </button>
<button onclick="clearMenu()" > Clear Menu </button>

<p id="MENU"> </p> 
<p id="Order"> </p> 

</body>

</html>